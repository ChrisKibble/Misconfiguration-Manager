![Sponsored by SpecterOps](https://img.shields.io/endpoint?url=https%3A%2F%2Fraw.githubusercontent.com%2Fspecterops%2F.github%2Fmain%2Fconfig%2Fshield.json)

# Misconfiguration Manager
This repository serves as a central knowledge-base for all known Microsoft Endpoint Configuration Manager (AKA MECEM, ConfigMgr,  Systems Center Configuration Manager or SCCM) tradecraft and associated defensive and hardening guidance.

Rather than writing a long, dull whitepaper, we opted to create a living, community-driven knowledge-base aimed at both offensive and defensive security professionals, as well as systems administrators.

At SpecterOps, we've abused many of the misconfigurations highlighted in this repository in real-world environments while a few are more experimental research projects proved out in a lab.

As the community continues to research SCCM's attack surface, we must also rely on contributions from the community to keep this repository up-to-date and as helpful as possible. Please submit a PR if you've identified a gap that we've missed!


## SCCM Attacks Matrix
|  Reconaissance                                                               | Initial Access                                                               | Execution                                                                          | Persistence                                                                        | Privilege Escalation                                                              | Defense Evasion                                                               | Credential Access                                                                             | Discovery                                                                     | Lateral Movement                                                                      | Collection	                                                            | Command and Control                                                       | Exfiltration                                                              | Impact                                                                              |
|:---:	                                                                       |:---:                                                                         |:---:	                                                                           |:---:                                                                               |:---:	                                                                            |:---:                                                                          |:---:	                                                                                        |:---:	                                                                        |:---:	                                                                                |:---:	                                                                    |:---:	                                                                    |:---:	                                                                    |:---:	                                                                              |
|  [RECON-1](./attack-techniques/RECON/RECON-1/recon-1_description.md)         | [CRED-1](./attack-techniques/CRED/CRED-1/cred-1_description.md)              | [EXEC-1]                                                                           |   	                                                                                | [CRED-1](./attack-techniques/CRED/CRED-1/cred-1_description.md)                   |   	                                                                        | [CRED-1](./attack-techniques/CRED/CRED-1/cred-1_description.md)                               |   	                                                                        | [TAKEOVER01](./attack-techniques/TAKEOVER01/takeover01-description.md)                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |
|  [RECON-2] 	                                                               |   	                                                                          | [EXEC-2]                                                                           |   	                                                                                | [CRED-2](./attack-techniques/CRED/CRED-2/cred-2_description.md)                   |   	                                                                        | [CRED-2](./attack-techniques/CRED/CRED-2/cred-2_description.md)                               |   	                                                                        | [TAKEOVER02](./attack-techniques/TAKEOVER02/takeover02-description.md)                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |
|  [RECON-3] 	                                                               |   	                                                                          |   	                                                                               |   	                                                                                | [CRED-3](./attack-techniques/CRED/CRED-3/cred-3_description.md)                   |   	                                                                        | [CRED-3](./attack-techniques/CRED/CRED-3/cred-3_description.md)                               |   	                                                                        | [TAKEOVER03](./attack-techniques/TAKEOVER03/takeover03-description.md)                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |
|  [RECON-4](./attack-techniques/RECON/RECON-4/recon-4_description.md)         |   	                                                                          |   	                                                                               |   	                                                                                | [CRED-4](./attack-techniques/CRED/CRED-4/cred-4_description.md)                   |   	                                                                        | [CRED-4](./attack-techniques/CRED/CRED-4/cred-4_description.md)                               |   	                                                                        |   	                                                                                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |
|   	                                                                       |   	                                                                          |   	                                                                               |   	                                                                                | [CRED-5](./attack-techniques/CRED/CRED-5/cred-5_description.md)                   |   	                                                                        | [CRED-5](./attack-techniques/CRED/CRED-5/cred-5_description.md)                               |   	                                                                        |   	                                                                                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |
|   	                                                                       |   	                                                                          |   	                                                                               |   	                                                                                | [TAKEOVER-1](./attack-techniques/TAKEOVER/TAKEOVER-1/takeover-1_description.md)   |   	                                                                        |   	                                                                                        |   	                                                                        |   	                                                                                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |
|   	                                                                       |   	                                                                          |   	                                                                               |   	                                                                                | [TAKEOVER-2](./attack-techniques/TAKEOVER/TAKEOVER-2/takeover-2_description.md)   |   	                                                                        |   	                                                                                        |   	                                                                        |   	                                                                                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |
|   	                                                                       |   	                                                                          |   	                                                                               |   	                                                                                | [TAKEOVER-3](./attack-techniques/TAKEOVER/TAKEOVER-3/takeover-3_description.md)   |   	                                                                        |   	                                                                                        |   	                                                                        |   	                                                                                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |
|   	                                                                       |   	                                                                          |   	                                                                               |   	                                                                                |   	                                                                            |   	                                                                        |   	                                                                                        |   	                                                                        |   	                                                                                |   	                                                                    |   	                                                                    |   	                                                                    |   	                                                                              |



## SCCM Attack and Defense Matrix
|                      | CRED&#x2011;1        | CRED&#x2011;2         | CRED&#x2011;3        | CRED&#x2011;4       | CRED&#x2011;5        | ELEVATE&#x2011;1     | EXEC&#x2011;1        | EXEC&#x2011;2        | RECON&#x2011;1       | RECON&#x2011;2       | RECON&#x2011;3       | RECON&#x2011;4       | TAKEOVER&#x2011;1    | TAKEOVER&#x2011;2    | TAKEOVER&#x2011;3    | TAKEOVER&#x2011;4    | TAKEOVER&#x2011;5    |
|:---------------------|:--------------------:|:---------------------:|:--------------------:|:-------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|:--------------------:|
| **PREVENT&#x2011;1** |                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      | 
| **PREVENT&#x2011;2** |                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      | X                    |                      |                      |                      |                      |
| **PREVENT&#x2011;3** | X                    | X                     | X                    | X                   |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;4** |                      | X                     | X                    | X                   |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;5** |                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      | 
| **PREVENT&#x2011;6** | X                    |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      | 
| **PREVENT&#x2011;7** | X                    |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;8** |                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;9** |                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      | X                    |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;10**|                      | X                     | X                    | X                   |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;11**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;12**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      | X                    |                      |                      |                      |                      |
| **PREVENT&#x2011;13**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;14**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      | X                    |                      |                      |                      |                      |
| **PREVENT&#x2011;15**|                      |                       |                      | X                   |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;16**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;17**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;18**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;19**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;20**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;21**| X                    |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;22**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |
| **PREVENT&#x2011;23**|                      |                       |                      |                     |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |                      |